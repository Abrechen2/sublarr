---
phase: 20-translation-memory-cache
plan: 02
type: execute
wave: 2
depends_on: ["20-01"]
files_modified:
  - frontend/src/pages/Settings/TranslationTab.tsx
  - frontend/src/api/client.ts
  - frontend/src/hooks/useApi.ts
autonomous: false

must_haves:
  truths:
    - "User can configure translation memory similarity threshold in Settings Translation"
    - "User can clear the translation memory cache via a button in Settings"
    - "Optional: cache entry count or stats displayed in Settings"
  artifacts:
    - path: "frontend/src/pages/Settings/TranslationTab.tsx"
      provides: "Translation memory section: similarity threshold, Clear cache button"
    - path: "frontend/src/api/client.ts"
      provides: "clearTranslationMemoryCache, getTranslationMemoryStats (if backend exposes)"
    - path: "frontend/src/hooks/useApi.ts"
      provides: "useClearTranslationMemoryCache mutation, useTranslationMemoryStats query"
  key_links:
    - from: "frontend/src/pages/Settings/TranslationTab.tsx"
      to: "frontend/src/hooks/useApi.ts"
      via: "clear cache mutation and stats query"
---

<objective>
Frontend: Settings UI for translation memory — similarity threshold and clear cache.

Purpose: Users configure the similarity threshold (exact vs near-identical match) and can clear the translation memory cache from Settings > Translation.

Output: Translation memory subsection in Translation tab with threshold control and Clear cache button; optional stats display.
</objective>

<execution_context>
@C:/Users/Dennis Wittke/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Dennis Wittke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/20-translation-memory-cache/20-01-SUMMARY.md

@frontend/src/pages/Settings/TranslationTab.tsx
@frontend/src/api/client.ts
@frontend/src/hooks/useApi.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: API client and hooks for translation memory</name>
  <files>
    frontend/src/api/client.ts
    frontend/src/hooks/useApi.ts
  </files>
  <action>
1. Add clearTranslationMemoryCache(): DELETE (or POST) to /api/v1/translation-memory/cache (or /clear). Add getTranslationMemoryStats() if backend exposes GET /translation-memory/stats.
2. Add useClearTranslationMemoryCache() mutation; on success invalidate translation memory stats if used. Add useTranslationMemoryStats() query if backend has stats. Add hooks for reading/writing translation_memory_similarity_threshold and translation_memory_enabled if exposed via config API.
  </action>
  <verify>
    Run: `cd frontend && npx tsc --noEmit` and `npm run lint`.
  </verify>
  <done>
    API functions and hooks for clear cache and optional stats; config hooks for threshold/enabled.
  </done>
</task>

<task type="auto">
  <name>Task 2: Translation memory UI in Translation tab</name>
  <files>
    frontend/src/pages/Settings/TranslationTab.tsx
  </files>
  <action>
1. Add a "Translation memory" section: checkbox or toggle to enable/disable (if backend supports), number input for similarity threshold (0.0–1.0, e.g. 1.0 = exact only). Help text: "Reuse cached translations for identical or similar lines. Similarity 1.0 = exact match only."
2. Button "Clear translation memory" with confirmation (e.g. window.confirm). On success show toast or message.
3. Optional: display cache entry count from GET stats if available.
  </action>
  <verify>
    Run: `cd frontend && npx tsc --noEmit` and `npm run build`. Manually: clear cache, confirm UI updates.
  </verify>
  <done>
    Translation tab has translation memory controls and Clear cache button; confirmation and feedback.
  </done>
</task>

</tasks>

<verification>
1. Settings Translation tab has translation memory subsection with threshold and Clear cache.
2. Clear cache calls API and shows confirmation and success feedback.
3. TypeScript and build succeed.
</verification>

<success_criteria>
- User can configure similarity threshold and clear the cache from Settings.
- No regression in other Translation settings.
</success_criteria>

<output>
After completion, create `.planning/phases/20-translation-memory-cache/20-02-SUMMARY.md`
</output>
